<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.northstar.bi.dao.ProjectDao">

	<resultMap type="Project" id="getProjectResultMap">
		<id column="pjt_no" property="no"/>
		<result column="pjt_title" property="title"/>
		<result column="pjt_start_date" property="startDate"/>
		<result column="pjt_end_date" property="endDate"/>
		<result column="pjt_content" property="content"/>
		<result column="pjt_remark" property="remark"/>
		<result column="pjt_flag" property="flag"/>
		<result column="pjt_msg" property="msg"/>
		<association property="company" column="com_no" javaType="Company" select="com.northstar.bi.dao.CompanyDao.getCompanyByComNo"/>
		<collection property="emps" column="pjt_no" javaType="java.util.ArrayList" ofType="int" select="com.northstar.bi.dao.EmpDao.getEmpByProNo"/>
	</resultMap>
	
	<select id="getProjectList" resultType="Project">
		select
			P.pjt_no				as no,
			C.com_no				as "company.no",
			C.com_name				as "company.name",
			P.pjt_title				as title,
			P.pjt_start_date		as startDate,
			P.pjt_end_date			as endDate,
			P.pjt_content			as content,
			P.pjt_remark			as remark,
			P.pjt_flag				as flag,
			P.pjt_msg				as msg
		from
			bi_project P, bi_company C
		where
			P.com_no = C.com_no	
	</select>
	<select id="getProjectByNo" parameterType="int" resultMap="getProjectResultMap">
		select
			pjt_no,
			com_no,
			pjt_title,
			pjt_start_date,
			pjt_end_date,
			pjt_content,
			pjt_remark,
			pjt_flag,
			pjt_msg
		from
			bi_project 
		where
			pjt_no = #{value} 
	</select>
</mapper>